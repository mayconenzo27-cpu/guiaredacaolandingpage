(()=>{var P=Object.defineProperty,R=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var T=(i,e,r)=>e in i?P(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,w=(i,e)=>{for(var r in e||(e={}))N.call(e,r)&&T(i,r,e[r]);if(C)for(var r of C(e))$.call(e,r)&&T(i,r,e[r]);return i},b=(i,e)=>R(i,B(e));var j=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var S=(i,e,r)=>new Promise((k,p)=>{var A=a=>{try{l(r.next(a))}catch(u){p(u)}},d=a=>{try{l(r.throw(a))}catch(u){p(u)}},l=a=>a.done?k(a.value):Promise.resolve(a.value).then(A,d);l((r=r.apply(i,e)).next())});var H=j(O=>{(function(){var D;let i=document.currentScript,e="dub_id",r="dub_partner_data",k=90*24*60*60*1e3,p=window.location.hostname,A=i.getAttribute("data-api-host")||"https://api.dub.co",d=i.getAttribute("data-publishable-key"),l=(()=>{let c={domain:p==="localhost"?void 0:`.${p.replace(/^www\./,"")}`,path:"/",sameSite:"Lax",expires:new Date(Date.now()+k).toUTCString()},o=i.getAttribute("data-cookie-options");if(!o)return c;let t=JSON.parse(o);return t.expiresInDays&&(t.expires=new Date(Date.now()+t.expiresInDays*24*60*60*1e3).toUTCString(),delete t.expiresInDays),w(w({},c),t)})(),a=(()=>{let c=i.getAttribute("data-short-domain"),o=i.getAttribute("data-domains");if(o)try{let t=JSON.parse(o);return b(w({},t),{refer:t.refer||c})}catch(t){}return{refer:c}})(),u=a.refer,f=i.getAttribute("data-attribution-model")||"last-click",I=i.getAttribute("data-query-param")||"via",h=new URLSearchParams(location.search).get(I);if(window.DubAnalytics=window.DubAnalytics||{partner:null,discount:null},window.dubAnalytics){let t=function(s,...n){s==="ready"?t.ready(...n):s==="trackClick"?t.trackClick(...n):console.warn("[dubAnalytics] Unknown method:",s)};var M=t;let o=window.dubAnalytics.q||[];t.q=o,t.ready=function(s){s()},t.trackClick=function(...s){g(...s)},window.dubAnalytics=t}let y={get(c){var o;return(o=document.cookie.split(";").map(t=>t.trim().split("=")).find(([t])=>t===c))==null?void 0:o[1]},set(c,o){let t=Object.entries(l).filter(([,s])=>s).map(([s,n])=>`${s}=${n}`).join("; ");document.cookie=`${c}=${o}; ${t}`}},m={queue:((D=window.dubAnalytics)==null?void 0:D.q)||[],flush(c){let o=[];for(;this.queue.length;){let[t,...s]=this.queue.shift();!c||c(t)?this.process({method:t,args:s}):o.push([t,...s])}this.queue=o},process({method:c,args:o}){if(c==="ready"){let t=o[0];t()}else["trackClick"].includes(c)?g(...o):console.warn("[dubAnalytics] Unknown method:",c)}},_=!1;function g({domain:c,key:o}){if(_)return;_=!0;let s=new URLSearchParams(location.search).get(e);fetch(`${A}/track/click`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:c,key:o,url:window.location.href,referrer:document.referrer})}).then(n=>n.ok&&n.json()).then(n=>{if(n){if(s&&s!==n.clickId){console.warn(`[dubAnalytics] Client-tracked click ID ${n.clickId} does not match server-tracked click ID ${s}, skipping...`);return}if(y.set(e,n.clickId),n.partner){let E=b(w({},n),{partner:b(w({},n.partner),{name:encodeURIComponent(n.partner.name),image:n.partner.image?encodeURIComponent(n.partner.image):null})});y.set(r,JSON.stringify(E)),DubAnalytics.partner=n.partner,DubAnalytics.discount=n.discount,m.flush(L=>L==="ready")}return n}})}function q(){let c=new URLSearchParams(location.search),o=()=>!y.get(e)||f!=="first-click",t=c.get(e);t&&o()&&y.set(e,t),h&&u&&o()&&g({domain:u,key:h}),m.flush(n=>n==="trackClick");let s=y.get(r);if(s)try{let n=JSON.parse(s);DubAnalytics.partner=n.partner,DubAnalytics.discount=n.discount}catch(n){console.error("[dubAnalytics] Failed to parse partner cookie:",n)}}window._dubAnalytics={c:y,i:e,h:p,a:A,o:l,d:u,m:f,p:I,v:h,n:a,k:d,qm:m},q()})();var U=()=>{let{a:i,k:e,c:r,i:k}=window._dubAnalytics||{};if(!i){console.warn("[dubAnalytics] Missing API_HOST");return}if(!e){console.warn("[dubAnalytics] Missing PUBLISHABLE_KEY");return}let p=d=>S(O,null,function*(){let l=r==null?void 0:r.get(k),a=w({clickId:l!=null?l:""},d),u=yield fetch(`${i}/track/lead/client`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(a)}),f=yield u.json();return u.ok||console.error("[dubAnalytics] trackLead failed",f.error),f}),A=d=>S(O,null,function*(){let l=r==null?void 0:r.get(k),a=w({clickId:l!=null?l:""},d),u=yield fetch(`${i}/track/sale/client`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(a)}),f=yield u.json();return u.ok||console.error("[dubAnalytics] trackSale failed",f.error),f});if(window.dubAnalytics&&(window.dubAnalytics.trackLead=function(...d){p(...d)},window.dubAnalytics.trackSale=function(...d){A(...d)}),window._dubAnalytics&&window._dubAnalytics.qm){let d=window._dubAnalytics.qm,a=(d.queue||[]).filter(([u,...f])=>u==="trackLead"?(p(...f),!1):u==="trackSale"?(A(...f),!1):!0);d.queue=a}};window._dubAnalytics?U():window.addEventListener("load",U)});H();})();
