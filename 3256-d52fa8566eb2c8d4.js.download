try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="006ec0c3-466b-4f23-8bd6-1acafcc7961e",e._sentryDebugIdIdentifier="sentry-dbid-006ec0c3-466b-4f23-8bd6-1acafcc7961e")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[273,3256],{273:(e,t,r)=>{r.d(t,{QO:()=>s,a$:()=>o,cm:()=>i,gO:()=>a,workspaceKeys:()=>n});let s={all:["permissions"],get:(e,t)=>[...s.all,e,t]},a={all:["projects"],details:()=>[...a.all,"detail"],detail:e=>[...a.details(),e],sharedWithMe:()=>[...a.all,"shared"],pendingProjectInvites:()=>[...a.all,"pending-invites"],branches:e=>[...a.detail(e),"branches"],secretLinkId:e=>[...a.detail(e),"secret-link-id"],domains:e=>[...a.detail(e),"domains"],sourceCode:e=>[...a.detail(e),"source-code"],feedbackStatus:e=>[...a.detail(e),"feedback-status"],presence:e=>[...a.detail(e),"presence"],communityProjects:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"recent",r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return[...a.all,"community",e,t,r,s]},collaborators:e=>[...a.detail(e),"collaborators"],analytics:(e,t)=>[...a.detail(e),"analytics",t],analyticsTrend:e=>[...a.detail(e),"analytics-trend"],projectDetails:e=>[...a.detail(e),"details"],initialPrompt:e=>[...a.detail(e),"initial-prompt"],integrations:e=>[...a.detail(e),"integrations"],integration:(e,t)=>[...a.integrations(e),t]},n={all:["workspaces"],totalProjects:e=>[...n.all,e,"total-projects"],projects:e=>{let{workspaceId:t,userId:r,limit:s,isDraft:a=!1}=e;return[...n.detail(t),"projects",r,s,a?"draft":"published"]},membership:(e,t)=>[...n.all,e,"membership",t],memberships:(e,t)=>t?[...n.detail(e),"memberships",(null==t?void 0:t.query)||"",(null==t?void 0:t.status)||"all",(null==t?void 0:t.role)||"",(null==t?void 0:t.limit)||20,(null==t?void 0:t.offset)||0,(null==t?void 0:t.sortBy)||"joined_at",(null==t?void 0:t.sortOrder)||"desc"]:[...n.detail(e),"memberships"],detail:e=>[...n.all,e],supabaseOrganizations:(e,t)=>[...n.all,e,"supabase-organizations",t],unacceptedInvites:()=>[...n.all,"unaccepted-invites"],inviteUser:(e,t)=>[...n.all,e,"invite-user",t],workspaceRole:(e,t)=>[...n.all,e,"workspace-role",t],workspaceUsage:(e,t,r)=>[...n.all,e,"workspace-usage",t,r],workspaceUserTotalUsage:e=>[...n.all,e,"workspace-user-total-usage"],workspaceGithubInstallations:e=>[...n.all,e,"workspace-github-installations"],referralCode:(e,t)=>[...n.all,e,"referral-code",t],workspaces:e=>{let{userId:t}=e;return[...n.all,t,"workspaces"]},templates:e=>[...n.detail(e),"templates"],integrationsOAuthStatus:(e,t)=>[...n.detail(e),"integrations",{integrations:t}],integrationOAuthStatus:(e,t)=>[...n.detail(e),"integrations",t,"oauth"]},i={all:["github"],installations:()=>[...i.all,"installations"],repoAccessibility:e=>[...i.all,"repo-accessibility",e],repos:e=>[...i.all,"repos",null==e?void 0:e.account.login,null==e?void 0:e.target_type]},o={all:["users"],experimentalFeatures:()=>[...o.all,"experimental-features"],workspaces:()=>[...o.all,"workspaces"],workspace:e=>[...o.workspaces(),e],profile:e=>[...o.all,e],contributions:e=>[...o.all,"contributions",e],studentDomains:()=>[...o.all,"student-domains"],toolApprovalPreferences:()=>[...o.all,"preferences","tool-preferences"]}},1965:(e,t,r)=>{r.d(t,{L:()=>s});class s extends Error{constructor(e,t,r,s,a){super(t),this.type=e,this.details=r,this.status=s,this.traceId=a}}},2417:(e,t,r)=>{r.d(t,{G:()=>o,q:()=>i});var s=r(99289),a=r(36380),n=r(51252);let i=new a.E,o=e=>{let{children:t}=e;return(0,s.jsx)(n.Ht,{client:i,children:t})}},13534:(e,t,r)=>{function s(e){return e instanceof Error&&"number"==typeof e.status&&"data"in e&&"string"==typeof e.httpMethod}r.d(t,{NF:()=>s,uy:()=>n});class a{setResponseHandler(e){this.responseHandler=e}setErrorHandler(e){this.errorHandler=e}createUrl(e,t){let r=new URL("".concat(this.baseURL).concat(e));return t&&Object.entries(t).forEach(e=>{let[t,s]=e;null!=s&&r.searchParams.append(t,s)}),r.toString()}createRequestOptions(e,t,r){let s={...this.defaultHeaders,...(null==t?void 0:t.headers)||{}};r instanceof FormData||(s["Content-Type"]="application/json");let a={method:e,headers:s,credentials:this.withCredentials?"include":"same-origin",signal:null==t?void 0:t.signal};return void 0===r||["GET","HEAD"].includes(e)||(r instanceof FormData?a.body=r:a.body=JSON.stringify(r)),a}async processResponse(e,t){return this.responseHandler?await this.responseHandler(e,t):e}async processError(e,t){throw this.errorHandler&&(e=await this.errorHandler(e,t)),e}async request(e,t,r,s){try{let a=this.createUrl(t,null==r?void 0:r.params),n=this.createRequestOptions(e,r,s),i=await fetch(a,n);if(!i.ok){let t=Error("Request failed with status ".concat(i.status));t.response=i,t.status=i.status,t.statusText=i.statusText,t.httpMethod=e;let r=i.clone();try{t.data=await r.json()}catch(e){t.data=await i.text()}return this.processError(t,i)}if(204===i.status||"0"===i.headers.get("Content-Length"))return this.processResponse({},i);let o=await i.json();return this.processResponse(o,i)}catch(e){return this.processError(e)}}async get(e,t){return this.request("GET",e,t)}async delete(e,t,r){return this.request("DELETE",e,r,t)}async head(e,t){return this.request("HEAD",e,t)}async post(e,t,r){return this.request("POST",e,r,t)}async postMultipart(e,t,r){return this.request("POST",e,r,t)}async put(e,t,r){return this.request("PUT",e,r,t)}async patch(e,t,r){return this.request("PATCH",e,r,t)}constructor(e,t={},r=!1){this.responseHandler=null,this.errorHandler=null,this.baseURL=e,this.defaultHeaders=t,this.withCredentials=r}}function n(e){return new a(e.baseURL,e.headers,e.withCredentials)}},24404:(e,t,r)=>{r.d(t,{T3:()=>h,WS:()=>u,dA:()=>l,fJ:()=>c,m9:()=>p});var s=r(38420),a=r(76918),n=r(69147),i=r(26787),o=r(32904);let l=(0,a.vt)(e=>({active:!1,message:void 0,providers:[],workspace:null,activate:t=>{let{message:r,providers:s,workspace:a}=t;return e({active:!0,message:r,providers:s,workspace:a})},deactivate:()=>e({active:!1,message:void 0,providers:[],workspace:null})}));function c(e){let{active:t}=l.getState();if(!t){l.getState().activate(e);{let{pathname:e,search:t,hash:s}=window.location;if("/sso/reauth"!==e){let a=encodeURIComponent("".concat(e).concat(t).concat(s));r.e(2291).then(r.bind(r,22291)).then(e=>{let{redirect:t}=e;return t("/sso/reauth?redirectTo=".concat(a))})}}}}async function d(e){let{userCredential:t,workspaceId:s,providerId:a,queryClient:o,onComplete:l,shouldRefreshPage:c=!1}=e,{workspaceKeys:d}=await r.e(273).then(r.bind(r,273)),{toast:u}=await Promise.resolve().then(r.bind(r,98213));try{i.j2.currentUser&&await i.j2.currentUser.getIdToken(!0),await o.invalidateQueries({queryKey:d.all}),u.success("Re-authentication successful",{description:"You can now access the workspace."}),c&&window.location.reload(),null==l||l()}catch(e){throw n.logging.error("reauth_token_refresh_failed",{error:e,workspaceId:s}),u.error("Re-authentication failed",{description:"Please try again or contact support."}),e}}async function u(e){let{auth:t,user:r,providerId:a,authType:o,onSuccess:l,onError:c,logContext:d={}}=e;try{let e,c=t||i.j2,u=new s.LD(a),h=function(){let e="localhost"===window.location.hostname,t=window.navigator.userAgent,r=t.includes("Safari")&&!t.includes("Chrome");return e||r}();if(n.logging.info("Starting SSO ".concat(o),{provider:a,usePopup:h,userId:(null==r?void 0:r.uid)||"anonymous",...d}),h){switch(o){case"signin":e=await (0,s.df)(c,u);break;case"reauth":if(!r)throw{code:"auth/missing-user",message:"User required for reauthentication"};e=await (0,s.Bm)(r,u),await e.user.getIdToken(!0),await e.user.getIdTokenResult(!0);break;case"link":if(!r)throw{code:"auth/missing-user",message:"User required for linking"};e=await (0,s.x8)(r,u)}await l(e)}else switch(o){case"signin":await (0,s.$2)(c,u);break;case"reauth":if(!r)throw{code:"auth/missing-user",message:"User required for reauthentication"};await (0,s.zT)(r,u);break;case"link":if(!r)throw{code:"auth/missing-user",message:"User required for linking"};await (0,s.dC)(r,u)}}catch(e){c(e,"sso ".concat(o))}}function h(e,t){return!!e&&e.providerData.some(e=>e.providerId===t)}function p(e){let{workspaceId:t,queryClient:r,onSuccess:s,shouldRefreshPage:a=!1,setIsLoading:n}=e;return{handleReauthSuccess:async(e,i)=>{try{await d({userCredential:e,workspaceId:t,providerId:i,queryClient:r,onComplete:s,shouldRefreshPage:a})}finally{n(!1)}},handleReauthError:(e,r,s)=>{(0,o.tu)({error:e,context:r,title:"Re-authentication failed",workspaceId:t,providerId:s||void 0,onComplete:()=>n(!1)})}}}},25276:(e,t,r)=>{r.d(t,{b:()=>h});var s=r(66394),a=r(66691);class n{get(e){return this.cacheMap[e]?this.cacheMap[e]:e}set(e,t){this.cacheMap={[e]:t}}constructor(){this.cacheMap={}}}let i=new n;async function o(e){var t;let{serverIdToken:r,refreshTokenUrl:n,checkRevoked:o}=e;if(!r)return null;let l=i.get(r),c=(0,s.i)(l),u=null!=(t=null==c?void 0:c.exp)?t:0,h=Date.now()/1e3;if(!o&&h+300<u)return l;let p=await d(n);if(!(null==p?void 0:p.idToken))throw new a.AuthError(a.AuthErrorCode.INTERNAL_ERROR,"Refresh token endpoint returned invalid response. This URL should point to endpoint exposed by the middleware and configured using refreshTokenPath option");return i.set(r,p.idToken),p.idToken}async function l(e,t,r){var s;let n=await c(e);return new a.AuthError(a.AuthErrorCode.INTERNAL_ERROR,"next-firebase-auth-edge: Internal request to ".concat(null!=(s=null==r?void 0:r.method)?s:"GET"," ").concat(t.toString()," has failed: ").concat(n))}function c(e){let t=e.headers.get("content-type");return t&&-1!==t.indexOf("application/json")?e.json():e.text()}async function d(e,t){let r=await fetch(e,{...t,headers:{...null==t?void 0:t.headers,Accept:"application/json","Content-Type":"application/json"}});if(!r.ok)throw await l(r,e,t);return c(r)}class u{setServerIdToken(e){this.serverIdToken=e,this.initialized=!0}isInitialized(){return this.initialized}async getValidToken(){if(!this.serverIdToken)return null;if(this.refreshPromise)return this.refreshPromise;try{this.refreshPromise=o({serverIdToken:this.serverIdToken,refreshTokenUrl:"/api/refresh-token"});let e=await this.refreshPromise;return this.refreshPromise=null,e}catch(e){return this.refreshPromise=null,null}}constructor(){this.serverIdToken=null,this.refreshPromise=null,this.initialized=!1}}let h=new u},25434:(e,t,r)=>{r.d(t,{C:()=>s});let s="production"===(r(40074).env.NEXT_PUBLIC_NODE_ENV||"production")?{apiKey:"AIzaSyBQNjlw9Vp4tP4VVeANzyPJnqbG2wLbYPw",authDomain:"auth.lovable.dev",projectId:"gpt-engineer-390607",storageBucket:"gpt-engineer-390607.appspot.com",messagingSenderId:"288002387414",appId:"1:288002387414:web:231da37c38c486ca814877",measurementId:"G-EFZ8TB5QLN",clientEmail:"firebase-adminsdk-thfj5@gpt-engineer-390607.iam.gserviceaccount.com"}:{apiKey:"AIzaSyC8MAnZTLUBttWHlEIMl0u8gGI0R5oGnXU",authDomain:"gpt-engineer-dev.firebaseapp.com",projectId:"gpt-engineer-dev",storageBucket:"gpt-engineer-dev.appspot.com",messagingSenderId:"435422046193",appId:"1:435422046193:web:36e2c4049799e14110c650",clientEmail:"firebase-adminsdk-tg5bc@gpt-engineer-dev.iam.gserviceaccount.com"}},26787:(e,t,r)=>{r.d(t,{j2:()=>u,OO:()=>h,db:()=>d,n_:()=>g});var s=r(38420),a=r(77555),n=r(69147),i=r(29373),o=r(82977),l=r(22803),c=r(25434);let{db:d,auth:u,database:h}=(()=>{let e=(0,i.Wp)(c.C),t=(0,l._A)(e,{experimentalForceLongPolling:!0}),r=(0,s.xI)(e),a=(0,o.C3)(e);return{app:e,db:t,auth:r,database:a}})(),p=!1,g=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!p&&t&&e){p=!0;let t=await (0,a.HD)({serverCustomToken:e,refreshTokenUrl:"/api/refresh-token"});if(!t)return p=!1,n.logging.error("No custom token found in initialize()"),{db:d,auth:u};try{await (0,s.p)(u,t)}catch(e){n.logging.error("Unable to sign-in with custom-token in firebase initialization: ".concat(e)),p=!1}}return{db:d,auth:u,database:h}}},32904:(e,t,r)=>{r.d(t,{C5:()=>n,W_:()=>i,tu:()=>o});var s=r(69147);let a={"auth/email-already-in-use":"errors.emailAlreadyInUse","auth/too-many-requests":"errors.tooManyRequests","auth/invalid-login-credentials":"errors.invalidLoginCredentials","auth/popup-blocked":"errors.popupBlocked","auth/operation-not-allowed":"errors.operationNotAllowed","auth/account-exists-with-different-credential":"errors.accountExistsWithDifferentCredential","auth/invalid-credential":"errors.invalidCredential","auth/missing-password":"errors.missingPassword","auth/user-cancelled":"errors.userCancelled","auth/popup-closed-by-user":"errors.popupClosedByUser","auth/requires-recent-login":"errors.requiresRecentLogin","auth/user-mismatch":"errors.userMismatch","auth/invalid-verification-code":"errors.invalidVerificationCode","auth/invalid-verification-id":"errors.invalidVerificationId","auth/credential-already-in-use":"errors.credentialAlreadyInUse","auth/weak-password":"errors.weakPassword","auth/wrong-password":"errors.wrongPassword","auth/user-not-found":"errors.userNotFound","auth/network-request-failed":"errors.networkRequestFailed","auth/internal-error":"errors.internalError","auth/invalid-api-key":"errors.invalidApiKey","auth/app-deleted":"errors.appDeleted","auth/user-disabled":"errors.userDisabled","auth/user-token-expired":"errors.userTokenExpired","auth/web-storage-unsupported":"errors.webStorageUnsupported","auth/invalid-email":"errors.invalidEmail","auth/cancelled-popup-request":"errors.cancelledPopupRequest","auth/unauthorized-domain":"errors.unauthorizedDomain"};function n(e,t){if("code"in e&&e.code){let n=a[e.code]||null;if(n&&t)try{var r;let s=null==(r=e.customData)?void 0:r.email;return s?t(n,{email:s}):t(n)}catch(e){s.logging.warn("Failed to translate auth error message",{error:e,translationKey:n})}return e.message||e.code}return e.message||"An unexpected error occurred"}function i(e){return["auth/user-cancelled","auth/popup-closed-by-user","auth/cancelled-popup-request"].includes(e)}function o(e){let{error:t,context:a,title:o="Authentication failed",workspaceId:l,providerId:c,userId:d,onComplete:u,showToast:h=!0,toastDuration:p=8e3,translate:g}=e;s.logging.error("auth_error_".concat(a.replace(/\s+/g,"_")),{error:(null==t?void 0:t.message)||t,code:null==t?void 0:t.code,context:a,workspaceId:l,provider:c,userId:d}),h&&Promise.resolve().then(r.bind(r,98213)).then(e=>{let{toast:r}=e;if((null==t?void 0:t.code)==="auth/popup-blocked"){let e=g?g("errors.popupBlocked"):"Please allow popups for this site and try again, or try using a different browser.";r.error("Popup was blocked",{description:e,duration:1e4})}else if(!i((null==t?void 0:t.code)||"")){let e=n(t,g);r.error(o,{description:e,duration:p})}}),null==u||u()}},33256:(e,t,r)=>{r.d(t,{P:()=>A,g:()=>T});var s=r(99490),a=r(2417),n=r(40007),i=r(25276),o=r(69147),l=r(67957),c=r(273);async function*d(e){yield*u(h(e))}async function*u(e){let t=null;for await(let r of e)if(!r.startsWith(":")){if(r.startsWith("event:")){t&&o.logging.error("received_sse_event_without_data",{event_type:t}),t=r.slice(6).trim();continue}if(r.startsWith("data:")){let e=r.slice(5).trimStart();try{yield{type:t,data:JSON.parse(e)}}catch(r){o.logging.error("failed_to_parse_sse_event",{error:r,event_type:t,event_data:e})}t=null}}}async function*h(e){let t=new TextDecoder,r="";for(;;){let{done:s,value:a}=await e.read(),n=(r+=t.decode(a,{stream:!s})).split(/\n+/);for(let e of(r=n.pop()||"",n))yield e;if(s){r&&(yield r);break}}}var p=r(1965),g=r(34936),f=r(13534),m=r(42676),v=r(69784),w=r(72134);let y=[/^\/user/,/^\/auth/,/^\/public/,/^\/health/];function E(e,t){return(0,f.uy)({baseURL:t,headers:e?{Authorization:"Bearer ".concat(e)}:void 0,withCredentials:!0})}class _{assertEndpointAccess(e){var t;if(t=e,!(!w.dA.getState().active||y.some(e=>e.test(t)))){let e=w.dA.getState();if(e.active)throw new p.L("sso_reauth_required",e.message||"SSO Session Expired");throw new p.L("access_denied","Access to this endpoint is restricted")}}async getApi(){if(!i.b.isInitialized())return await new Promise(e=>setTimeout(e,50)),this.getApi();let e=await i.b.getValidToken();e||(0,m.v)("Tried to get API with no valid ID token",{error:Error("Tried to get API with no valid ID token"),severity:l.$.ERROR});let t=E(e,this.baseURL),r=e=>{if(null==e?void 0:e.headers.get("Lovable-Cachebuster")){let e=new CustomEvent("lovable-cachebuster");document.dispatchEvent(e)}};return t.setResponseHandler((e,t)=>(r(t),e)),t.setErrorHandler((e,t)=>{if(r(t),e&&"object"==typeof e&&"status"in e){if(401===e.status){let e=window.location.pathname;n.y.emitAuthError(e)}403===e.status&&a.q.invalidateQueries({queryKey:c.QO.all})}return Promise.reject((0,g.yO)(e))}),t}async get(e,t){return this.assertEndpointAccess(e),(await this.getApi()).get(e,t)}async delete(e,t,r){return this.assertEndpointAccess(e),(await this.getApi()).delete(e,t,r)}async post(e,t,r){return this.assertEndpointAccess(e),(await this.getApi()).post(e,t,r)}async put(e,t,r){return this.assertEndpointAccess(e),(await this.getApi()).put(e,t,r)}async patch(e,t,r){return this.assertEndpointAccess(e),(await this.getApi()).patch(e,t,r)}async head(e,t){return this.assertEndpointAccess(e),(await this.getApi()).head(e,t)}async getWithStreaming(e){let{url:t,onMessage:r,params:s,signal:a,reconnectOptions:n}=e,l=w.dA.getState();if(l.active)throw new p.L("sso_reauth_required",l.message||"SSO Session Expired");let c={initialDelayMs:1e3,maxDelayMs:1e4,backoffFactor:2,retryCount:10,...n},u=0,h=async()=>{try{let e=await i.b.getValidToken(),n="".concat(this.baseURL).concat(t);if(s&&Object.keys(s).length>0){let e=new URLSearchParams(s).toString();n+=(t.includes("?")?"&":"?")+e}let l=await fetch(n,{method:"GET",headers:{...e?{Authorization:"Bearer ".concat(e)}:{},Accept:"text/event-stream",Connection:"keep-alive","Cache-Control":"no-cache"},signal:a}),c=l.headers.get("X-Trace-Id")||void 0;if(!l.ok){let e;try{let t=await l.text(),r=l.headers.get("Content-Type")||"";if(r.includes("application/json"))try{e=JSON.parse(t)}catch(s){o.logging.error("failed_to_parse_json_response",{error:s,responseText:t,contentType:r}),e=t}else o.logging.debug("non_json_error_response",{contentType:r,responseText:t}),e=t}catch(e){o.logging.error("failed_to_parse_response_body",{error:e,status:l.status,contentType:l.headers.get("Content-Type")})}if(429===l.status)throw new v.o("We are currently under heavy load, please try again later.",429,"RATE_LIMIT_EXCEEDED",e,c);throw new v.o("Request failed",l.status,l.statusText,e,c)}let u=l.body.getReader();try{for await(let e of d(u))if("error"===e.type)throw function(e,t){var r;let s=b.safeParse(e.data);if(!s.success)return o.logging.error("failed_to_parse_server_sse_error",{parse_error:s.error,event_data:e.data,traceId:t}),new p.L(g.i4.malformed,"Failed to parse server SSE error",void 0,500,t);let a=s.data,n=null!=(r=a.traceId)?r:t;return"Request cancelled"===a.message?new v.o("Request cancelled",499,"REQUEST_CANCELLED",a,n):(o.logging.error("server_sse_error",{error:a,traceId:n}),new v.o(a.message,500,a.type,a,n))}(e,c);else try{r(e)}catch(e){o.logging.error("unhandled_error_in_message_handler",{error:e})}}catch(e){if(await u.cancel().catch(()=>{}),e instanceof Error&&"AbortError"===e.name)return;if(e instanceof v.o){if(499===e.status)return void o.logging.info("stream_connection_cancelled",{url:t});throw e}throw o.logging.error("unexpected_error_during_sse",{error:e}),e}finally{u.releaseLock()}}catch(s){var e;if(s instanceof Error&&"AbortError"===s.name)return void o.logging.info("stream_connection_aborted",{url:t});if(s instanceof v.o&&"Request cancelled"===s.message)return void o.logging.info("stream_connection_cancelled",{url:t});if(s instanceof v.o&&"RATE_LIMIT_EXCEEDED"===s.statusText)throw s;if(u>=c.retryCount)throw o.logging.error("stream_connection_max_retries_exceeded",{url:t,maxRetries:c.retryCount,error:s}),s;let r=Math.min(c.initialDelayMs*Math.pow(c.backoffFactor,u),c.maxDelayMs);return o.logging.info("stream_connection_retry",{url:t,retryCount:u+1,maxRetries:c.retryCount,delayMs:r,error:s}),await new Promise(e=>setTimeout(e,r)),u++,null==n||null==(e=n.onReconnect)||e.call(n),h()}};return h()}constructor(e){this.baseURL=e}}let b=s.Ik({type:s.Yj(),message:s.Yj(),details:s.Yj(),traceId:s.Yj().optional()});var k=r(61625);let R=new _((0,k.N)());function A(){return R}function T(){return E(null,(0,k.N)())}},34936:(e,t,r)=>{r.d(t,{Ni:()=>p,i4:()=>d,yO:()=>h});var s=r(98213),a=r(99490),n=r(67957),i=r(1965),o=r(13534),l=r(42676),c=r(72134);let d={network:"network_error",malformed:"malformed_response"},u=a.Ik({type:a.Yj(),message:a.Yj().optional().transform(e=>e||void 0),details:a.Yj().optional().transform(e=>e||void 0)});function h(e){if((0,o.NF)(e)){var t,r,s;let a={url:null==(t=e.response)?void 0:t.url,method:e.httpMethod,status:e.status},o=(null==(s=e.response)||null==(r=s.headers)?void 0:r.get("X-Trace-Id"))||void 0;if(!e.response)return(0,l.v)("Network error",{error:e,severity:n.$.INFO,context:a}),new i.L(d.network,"Connection Error","Please check your internet connection");let h=e.data,p=u.safeParse(h);if(p.success){let t=new i.L(p.data.type,p.data.message||"",p.data.details,e.status,o);if((0,l.V)({error:t,severity:n.$.INFO,context:a}),"sso_reauth_required"===t.type)try{let e=h.props||{},r=Array.isArray(e.providers)?e.providers:[],s=e.workspace;s&&r.length>0&&(0,c.fJ)({message:t.message,providers:r,workspace:s})}catch(e){(0,l.v)("Failed to start SSO reauth flow",{error:e,severity:n.$.ERROR})}return t}return(0,l.v)("Bad error from backend",{error:e,severity:n.$.ERROR,context:{...a,error_data:h,response:e.response,zodError:p.error}}),new i.L(d.malformed,e.statusText||"",void 0,e.status,o)}return e instanceof TypeError&&/network|failed to fetch/i.test(e.message)?((0,l.v)("Native network error",{error:e,severity:n.$.INFO}),new i.L(d.network,"Connection Error","Please check your internet connection")):((0,l.v)("Unhandled error type",{error:e,severity:n.$.ERROR}),new i.L(d.malformed,""))}function p(e){e instanceof i.L?(s.toast.error(e.message||"Something went wrong",{duration:8e3,description:e.details}),e.message||(0,l.v)("User sees vague api error",{error:e,severity:n.$.ERROR})):(s.toast.error("Something went wrong",{description:"Lovable has been notified.",duration:8e3}),(0,l.v)("User sees vague error",{error:e,severity:n.$.ERROR}))}},40007:(e,t,r)=>{r.d(t,{y:()=>n});var s=r(13861);class a extends s.EventEmitter{emitAuthError(e){this.emit("auth:error",{pathname:e})}}let n=new a},42676:(e,t,r)=>{r.d(t,{V:()=>o,v:()=>l});var s=r(545),a=r(69147),n=r(67957);let i={[n.$.ERROR]:"error",[n.$.WARN]:"warn",[n.$.INFO]:"info",[n.$.DEBUG]:"debug",[n.$.TRACE]:"trace",[n.$.LOG]:"log"};function o(e){let{error:t,severity:r,context:o}=e,l={...o,errorType:t.type},c=i[r];a.logging[c]("api_error_".concat(t.type),{error:t,...l}),(r===n.$.ERROR||r===n.$.WARN)&&s.Cp(Error("API Error: ".concat(t.type)),{extra:{...t,...l}})}function l(e,t){let{error:r,severity:o,context:l}=t,c="".concat(e,": ").concat(r instanceof Error?r.message:"Weird error"),d=r instanceof Error?r:Error(c),u=i[o];a.logging[u](c,{...l,error:r}),(o===n.$.ERROR||o===n.$.WARN)&&(d.message=c,s.Cp(d,{level:o===n.$.ERROR?"error":"warning",extra:{...l,weird_error:r instanceof Error?void 0:r}}))}},61625:(e,t,r)=>{r.d(t,{N:()=>s});let s=()=>"https://lovable-api.com"},67957:(e,t,r)=>{r.d(t,{$:()=>s});var s=function(e){return e.LOG="LOG",e.TRACE="TRACE",e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e}({})},69147:(e,t,r)=>{r.d(t,{S:()=>u,logging:()=>g});var s=r(62276),a=r(76918),n=r(1965),i=r(69784),o=r(67957),l=r(40074);o.$.LOG,o.$.TRACE,o.$.DEBUG,o.$.INFO,o.$.WARN,o.$.ERROR,o.$.INFO;class c{static generateSessionId(){return(0,s.A)()}setSession(e){this._session={session_id:c.generateSessionId(),previous_session:this._session.session_id,project_id:e}}setUser(e){this._user=e}get session(){return this._session}get user(){return this._user}sessionForLogging(){let{session_id:e,...t}=this._session;return{session_id:e,...Object.fromEntries(Object.entries(t).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return["session_attrs_".concat(t),r]}))}}userForLogging(){return Object.fromEntries(Object.entries(this._user||{}).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return["user_".concat(t),r]}))}getForLogging(){return Object.fromEntries(Object.entries({...this.sessionForLogging(),...this.userForLogging()}).filter(e=>{let[t,r]=e;return void 0!==r}))}constructor(){this._session={session_id:c.generateSessionId()}}}let d=new c,u=(0,a.vt)(e=>({metadata:d,setMetadata:t=>e({metadata:t})})),h=async(e,t)=>{var r;let s=t[0],a=null!=(r=t[1])?r:{},o=(1e9*Math.floor(Date.now()/1e3)).toString(),c=Object.entries({msg:s,...a,...d.getForLogging(),level:e}).map(e=>{let[t,r]=e;return"".concat(t,"=").concat(JSON.stringify(r,function e(t,r){return r instanceof i.o?{error_class:"StreamedFetchError",message:r.message,status:r.status,statusText:r.statusText,response:e("response",r.response),stack:r.stack}:r instanceof n.L?{error_class:"ApiError",type:r.type,message:r.message,details:r.details,status:r.status,stack:r.stack}:r instanceof Error?{error_class:r.constructor.name,message:r.message,stack:r.stack}:r}))}).join(" "),u={streams:[{stream:{service_name:"gptengineer-app",name:"gptengineer-app",version:l.env.NEXT_PUBLIC_VERSION||"1.0.0",environment:"production",commit_sha:"$COMMIT_REF",level:e},values:[[o,c]]}]},h="https://us-central1-gpt-engineer-390607.cloudfunctions.net/pushLogsToGrafana";if(h)try{await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})}catch(e){}},p=(e,t)=>{h(e,t)},g={info:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(o.$.INFO,t)},debug:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(o.$.DEBUG,t)},trace:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(o.$.TRACE,t)},warn:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(o.$.WARN,t)},error:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(o.$.ERROR,t)},log:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(o.$.LOG,t)}}},69784:(e,t,r)=>{r.d(t,{o:()=>s});class s extends Error{constructor(e,t,r,s,a){super(e),this.status=t,this.statusText=r,this.response=s,this.traceId=a}}},72134:(e,t,r)=>{r.d(t,{dA:()=>s.dA,fJ:()=>s.fJ}),r(32904);var s=r(24404)}}]);